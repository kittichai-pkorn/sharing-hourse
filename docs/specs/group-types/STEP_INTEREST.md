# STEP_INTEREST (ขั้นบันได)

## หลักการ

> ลูกแชร์แต่ละคน **ส่งยอดต่างกัน** แต่ **รับเงินต้นเท่ากัน**

```
┌─────────────────────────────────────────────────────────┐
│  ลูกแชร์ส่งยอดต่างกัน  →  ผู้เปียรับเงินต้นเท่ากัน        │
│                                                         │
│  เต้  ส่ง 240 ─┐                                        │
│  เต้ง ส่ง 220 ─┤                                        │
│  ทิม  ส่ง 180 ─┼──→  ผู้เปีย รับ 1,000 บาท (เงินต้น)     │
│  ตุ๊ก  ส่ง 160 ─┤                                        │
│  ต้น  ส่ง 140 ─┘                                        │
└─────────────────────────────────────────────────────────┘
```

---

## ตัวอย่างจริง

### ตั้งค่าวง
| รายการ | ค่า |
|--------|-----|
| เงินต้น | 1,000 บาท |
| จำนวนมือ | 7 คน |
| หักท้าย | 1 งวด |

### สมาชิก (ยอดส่งต่างกัน)
| สมาชิก | ยอดส่ง/งวด | หมายเหตุ |
|--------|------------|----------|
| ท้าว | 0 | ไม่ต้องส่ง |
| เต้ | 240 | ส่งมาก = หักมาก |
| เต้ง | 220 | |
| ทิม | 180 | |
| ตุ๊ก | 160 | |
| ต้น | 140 | ส่งน้อย = หักน้อย |

> ยอดส่งรวม = 240+220+180+160+140 = **940 บาท**

### ตารางงวด (หักท้าย = 1)
| งวด | ลูกแชร์ | ยอดรับ | หักรับ | สุทธิ | หมายเหตุ |
|-----|---------|--------|--------|-------|----------|
| 1 | ท้าว | 1,000 | 0 | **940** | งวดแรก = ยอดส่งลูกแชร์รวม |
| 2 | เต้ | 1,000 | 480 | **520** | หักรับ = 240×2 (รวมหักท้าย) |
| 3 | เต้ง | 1,000 | 440 | **560** | หักรับ = 220×2 (รวมหักท้าย) |
| 4 | ทิม | 1,000 | 360 | **640** | หักรับ = 180×2 (รวมหักท้าย) |
| 5 | ตุ๊ก | 1,000 | 320 | **680** | หักรับ = 160×2 (รวมหักท้าย) |
| 6 | ต้น | 1,000 | 280 | **720** | หักรับ = 140×2 (รวมหักท้าย) |
| 7 | ท้าว | 1,000 | 0 | **940** | หักท้าย = ยอดส่งลูกแชร์รวม |

> **หมายเหตุ**: ยอดรับ = เงินต้น (1,000 บาท) ทุกงวด

---

## สูตรคำนวณ

### งวดแรก (ท้าวเปีย)
```
ยอดรับสุทธิ = ยอดส่งของลูกแชร์ทั้งหมดรวมกัน
           = 240 + 220 + 180 + 160 + 140 = 940 บาท
```

### งวดลูกแชร์เปีย (มีหักท้าย)
```
ยอดรับ       = เงินต้น
หักรับ       = ยอดส่งของผู้เปีย × (1 + หักท้าย)
ยอดรับสุทธิ   = ยอดรับ - หักรับ
```

### ตัวอย่าง: เต้เปียงวด 2 (หักท้าย = 1)
```
ยอดรับ       = 1,000 บาท
หักรับ       = 240 × 2 = 480 บาท
ยอดรับสุทธิ   = 1,000 - 480 = 520 บาท
```

---

## กฎสำคัญ

### 1. ผู้เปีย
| งวด | ใครได้ | วิธี |
|-----|--------|------|
| งวดแรก | ท้าว | อัตโนมัติ |
| งวด 2+ | ลูกแชร์ | กำหนดล่วงหน้า |

### 2. การส่งเงิน
| สมาชิก | ส่งเงิน |
|--------|---------|
| ท้าว | ไม่ต้องส่ง |
| ลูกแชร์ | ส่งยอดคงที่ทุกงวด (แม้เปียแล้ว) |

### 3. หักท้าย
- เป็น flag บอกว่าจะหักยอดส่งงวดสุดท้ายเพิ่มหรือไม่
- ถ้าหักท้าย = 1 → หักรับ = ยอดส่ง × 2
- ถ้าหักท้าย = 0 → หักรับ = ยอดส่ง × 1

---

## ฟิลด์ตั้งค่า

### ฟิลด์วง
| ฟิลด์ | บังคับ | คำอธิบาย |
|-------|:------:|----------|
| ชื่อวงแชร์ | * | |
| เงินต้น | * | ยอดที่ผู้เปียได้รับ |
| จำนวนมือ | * | รวมท้าว |
| รอบชำระ | * | รายวัน/สัปดาห์/เดือน |
| วันเริ่ม | * | |
| หักท้าย | | จำนวนงวด (ดูรายละเอียดด้านล่าง) |
| ค่าดูแลวง | | หักจากผู้เปีย |

---

## หักท้าย คืออะไร?

> **หักท้าย** = หักยอดส่งงวดสุดท้ายของลูกแชร์ ตอนคำนวณหักรับ

### ตัวอย่าง: หักท้าย = 1 งวด

เมื่อลูกแชร์เปีย จะหักยอดส่งของเขา **รวมงวดสุดท้ายด้วย**

| ผู้เปีย | ยอดส่ง/งวด | หักรับปกติ | หักท้าย (+1 งวด) | หักรับรวม |
|---------|------------|------------|------------------|-----------|
| เต้ | 240 | 240 | +240 | **480** |
| เต้ง | 220 | 220 | +220 | **440** |
| ทิม | 180 | 180 | +180 | **360** |
| ตุ๊ก | 160 | 160 | +160 | **320** |
| ต้น | 140 | 140 | +140 | **280** |

### สูตร
```
หักรับ = ยอดส่งของผู้เปีย × (1 + หักท้าย)
```

### ฟิลด์สมาชิก
| ฟิลด์ | บังคับ | คำอธิบาย |
|-------|:------:|----------|
| ยอดส่ง | * | ยอดที่ส่งทุกงวด (ท้าว = 0) |

---

*v1.5 | Dec 2024*
