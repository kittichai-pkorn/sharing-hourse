# Story 4.3: แสดงตารางงวด

## Info
| Field | Value |
|-------|-------|
| Epic | 4. รายละเอียดวงแชร์ |
| Priority | P0 |
| Points | 3 (M) |
| Status | Draft |

---

## User Story

```
As a: ท้าวแชร์
I want to: เห็นตารางงวดพร้อมสถานะและยอดเงิน
So that: ติดตามความคืบหน้าของแต่ละงวดได้
```

---

## Acceptance Criteria

- [ ] แสดงตารางงวดพร้อมคอลัมน์: งวด, วันที่, ผู้เปีย, ยอดรับ, หักรับ, สุทธิ, จัดการ
- [ ] แสดงวิธีการได้: งวดแรก, กำหนดล่วงหน้า, หักท้าย (badge ใต้ชื่อผู้เปีย)
- [ ] ปุ่มจัดการ: หักรับ, ชำระ

---

## สูตรคำนวณ (STEP_INTEREST)

```
ยอดรับ     = เงินต้น
ยอดหักรับ  = รายการหักรับ + หักท้าย + ค่าดูแล
ยอดรับสุทธิ = เงินต้น - ยอดหักรับ
```

---

## UI/UX

### ตารางงวด

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│  ตารางงวด (7)                                                                                │
├─────────────────────────────────────────────────────────────────────────────────────────────┤
│ งวด │ วันที่       │ ผู้เปีย                    │ ยอดรับ  │ หักรับ  │ สุทธิ   │ จัดการ        │
│─────┼──────────────┼────────────────────────────┼─────────┼─────────┼─────────┼───────────────│
│ 1   │ 1 ม.ค. 68    │ ท้าว                       │ 1,000   │ -       │ 940     │ [หักรับ][ชำระ] │
│     │              │ 🟣 งวดแรก                  │         │         │ (green) │               │
│─────┼──────────────┼────────────────────────────┼─────────┼─────────┼─────────┼───────────────│
│ 2   │ 1 ก.พ. 68    │ เต้                        │ 1,000   │ 480     │ 520     │ [หักรับ][ชำระ] │
│     │              │ 🔵 กำหนดล่วงหน้า           │         │ (orange)│ (green) │               │
│─────┼──────────────┼────────────────────────────┼─────────┼─────────┼─────────┼───────────────│
│ 3-6 │ ...          │ [Dropdown▾]                │ -       │ -       │ -       │ [หักรับ][ชำระ] │
│     │              │ -                          │         │         │         │               │
│─────┼──────────────┼────────────────────────────┼─────────┼─────────┼─────────┼───────────────│
│ 7   │ 1 ก.ค. 68    │ ท้าว                       │ 1,000   │ -       │ 940     │ [หักรับ][ชำระ] │
│     │              │ 🟣 หักท้าย                 │         │         │ (green) │               │
└─────────────────────────────────────────────────────────────────────────────────────────────┘
```

### หมายเหตุ
- งวด 3-6: แสดง Dropdown สำหรับเลือกผู้เปีย (เฉพาะ STEP_INTEREST)
- ยอดรับ, หักรับ, สุทธิ แสดงเฉพาะเมื่อมีผู้เปีย (winnerId)
- หักรับ: สีส้ม (orange)
- สุทธิ: สีเขียว (green)
- ยอดรับ = เงินต้น (principalAmount)
- หักรับ = ยอดส่งของผู้เปีย + รายการหักอื่นๆ

### Method Badges

| Method | Badge | Color |
|--------|-------|-------|
| งวดแรก | 🟣 | Purple - Auto-assign for host |
| กำหนดล่วงหน้า | 🔵 | Blue - Pre-assigned via dropdown |
| หักท้าย | 🟣 | Purple - Auto-assign for host (tail) |

---

## Data Structure

```typescript
interface Round {
  id: number;
  roundNumber: number;
  status: 'PENDING' | 'ACTIVE' | 'COMPLETED';
  winnerId: number | null;
  winningBid: number | null;
  payoutAmount: number | null;
  dueDate: string | null;
}
```

---

## Files

- `frontend/src/pages/dashboard/ShareGroupDetailPage.tsx` - Rounds table

---

*v1.0 | Dec 2024*
